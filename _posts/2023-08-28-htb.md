---
title: "Hack the Box Blue Team"
categories:
  - dev
  - sysadmin
  - netadmin
  - aws
  - htb
tags:
  - dev
  - sysadmin
  - netadmin
  - aws
  - htb
comments: true
share: true
header:
  overlay_image: /assets/images/3600x3600.png
  caption: "Photo credit: [**Unsplash**](https://unsplash.com)"
  cta_url: "https://unsplash.com"
#image:
#  background: /assets/images/3600x3600.png
##background_image: https://InnovAnon-Inc.github.io/assets/images/3600x3600.png
##image: https://InnovAnon-Inc.github.io/assets/images/3600x3600.png
##background: https://InnovAnon-Inc.github.io/assets/images/3600x3600.png
---

Basic process:
- Create AWS EC2 instance for CA, LDAP
- Create key/crt/chains
  - Root CA
  - Intermediate CAs for servers and users
  - VPN key/crt/chain and user key/crt/chain
- Create AWS Lambda function for DDNS
- Create AWS EC2 instance to host CRL
- Setup AWS Client VPN endpoint to connect to RDS
- Setup AWS RDS for LDAP, msf database
- Setup docker/LDAP 
- Create HTB team

UPDATE:

AWS free tier does not include RDS/VPN/VPC, etc.,
so we're back to running things in docker.
It's quicker and easier anyway.
Their online console leaves something to be desired.

- DDNS
  - We are using residential networks and personal computers

- CA
  - There is no authority higher than InnovAnon, so we need this

- APT repo
  - Binary packages to simplify installation and maintenance of the
    specific tools we are using.

- DNS:
  - TODO Currently I need to get bind9 to listen on 0.0.0.0... or switch softwarez.
  - This should make it easier for the team to add hostnames for HTB machines.

- DB: postgre
  - MSF will use this backend

- [rsyslog](https://github.com/InnovAnon-Inc/pgopenldap)
  - Centralized syslog.
  - All other machines need syslog rules for logging to this server.
  - This server uses the PG backend.

- ACNG
  - docker => needs more cache

- Redis
  - Remote storage backend for ccache

- DistCC
  - We're gonna have a few different instances -- for different toolchain versions.
  - This uses DISTCC_CMDLIST to enable server-side ccache. Because Docker.
  - Public-facing projects should be compiled using GitHub Actions,
    but exploits, malware and other "one-off" compilations will be done "locally."

- [bash](https://github.com/InnovAnon-Inc/bash-syslog)
  - Bash history => syslog => postgre.
  - We monitor our team. For posterity.

- [slapd](https://github.com/InnovAnon-Inc/pgopenldap)
  - TODO how to use this now that I set it up?

- VPN Client 1
  - Connects to, e.g., ProtonVPN

- TOR or proxychains
  - Connects to VPN Client 1

- VPN Client 2
  - TODO
  - Uses TOR socks5 proxy
  - Connects to HTB

- Site-to-Site VPN Servers
  - BYO Hardwarez: >1 team member => multicluster.
  - TODO

- TODO
  - file sharing
    - NFS
    - Samba
    - http/ftp/rsync
  - memcached?
  - chat
    - private IRC
    - public IRC bridge
  - PXE?
    - => customize OS images to contain our tools and configurations out-of-the-box
  - CRM?

